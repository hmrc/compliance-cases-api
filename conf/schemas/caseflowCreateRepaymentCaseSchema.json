{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "description" : "Repayment Case",
  "type" : "object",
  "additionalProperties" : false,
  "required" : [
    "caseType",
    "sourceSystemRef",
    "repaymentAmount",
    "taxRegime",
    "taxPeriodStart",
    "taxPeriodEnd",
    "claimDate",
    "taxPayer"
  ],
  "properties" : {
    "caseType" : {
      "description" : "Mandatory. Must be 'Repayment' for a repayment case",
      "type" : "string",
      "enum" : [
        "Repayment"
      ]
    },
    "sourceSystemRef" : {
      "description" : "Mandatory. An identify reference; 'CFSRP' for a 'Repayment'",
      "type" : "string",
      "enum" : [
        "CFSRP"
      ]
    },
    "campaignId" : {
      "$ref" : "#/definitions/campaignIdType"
    },
    "projectId" : {
      "$ref" : "#/definitions/projectIdType"
    },
    "repaymentAmount" : {
      "$ref" : "#/definitions/amountType"
    },
    "taxRegime" : {
      "$ref" : "#/definitions/taxRegimeType"
    },
    "taxPeriodStart" : {
      "$ref" : "#/definitions/dateType"
    },
    "taxPeriodEnd" : {
      "$ref" : "#/definitions/dateType"
    },
    "caseOwnerId" : {
      "description" : "Optional. The numeric id of the owner of the case.",
      "type" : "number",
      "multipleOf" : 1,
      "minimum" : 1,
      "maximum" : 9999999
    },
    "triggeredRiskRuleRef" : {
      "description" : "Optional. A reference for the triggered risk rule on the source system",
      "type" : "string",
      "pattern" : "^R[0-9]{1,10}$",
      "example" : "R0123"
    },
    "oudn" : {
      "description" : "Optional. OUDN of the owner",
      "type" : "string",
      "pattern" : "^[A-Za-z0-9\\&\\-\\'\\_]{8,100}$",
      "example" : "ZA-0006667"
    },
    "claimDate" : {
      "$ref" : "#/definitions/dateType"
    },
    "taxPayer" : {
      "$ref" : "#/definitions/taxPayerType"
    }
  },
  "definitions": {
    "campaignIdType" : {
      "description" : "The campaign id relating to this case",
      "type" : "string",
      "pattern" : "^CID-[0-9]{1,15}$",
      "example" : "CID-000088934"
    },
    "projectIdType" : {
      "description" : "The project id relating to this case",
      "type" : "string",
      "pattern" : "^PID-[0-9]{1,15}$",
      "example" : "PID-29834579"
    },
    "amountType" : {
      "description" : "A number representing an amount in pence up to 15 digits",
      "type" : "number",
      "multipleOf" : 1,
      "minimum" : 0,
      "maximum" : 999999999999999,
      "example" : 1999
    },
    "taxRegimeType" : {
      "type" : "string",
      "description" : "Mandatory. The tax regime of the Repayment case or of a risk for a Risk case",
      "pattern" : "^[a-zA-Z_]{2,15}$",
      "example" : "AMLS"
    },
    "dateType" : {
      "description" : "A date in the format CCYY-MM-DD. Earliest 1900-01-01, latest 2099-12-31, leap years accommodated.",
      "type" : "string",
      "pattern" : "^(((19|20)([2468][048]|[13579][26]|0[48])|2000)[\\-]02[\\-]29|((19|20)[0-9]{2}[\\-](0[469]|11)[\\-](0[1-9]|1[0-9]|2[0-9]|30)|(19|20)[0-9]{2}[\\-](0[13578]|1[02])[\\-](0[1-9]|[12][0-9]|3[01])|(19|20)[0-9]{2}[\\-]02[\\-](0[1-9]|1[0-9]|2[0-8])))$",
      "example" : "2020-04-17"
    },
    "nameType" : {
      "type" : "string",
      "pattern" : "^[a-zA-Z &`\\-\\'\\.^]{1,35}$"
    },
    "organisationNameType" : {
      "type" : "string",
      "pattern" : "^[a-zA-Z0-9 &`\\-\\'\\.^]{1,70}$"
    },
    "addressLineType" : {
      "type" : "string",
      "pattern" : "^[A-Za-z0-9 \\-,\\.&\\'\\/]{1,35}$"
    },
    "addressEntry" : {
      "type" : "object",
      "additionalProperties" : false,
      "required" : [
        "addressLine1",
        "correspondenceAddress",
        "addressType"
      ],
      "properties" : {
        "correspondenceAddress" : {
          "description" : "Mandatory. Whether this address is a correspondence one (true) or not (false).",
          "type" : "boolean"
        },
        "addressType" : {
          "description" : "Mandatory. The type of the address.",
          "type" : "string",
          "pattern" : "^[A-Za-z ]{4,20}$",
          "example" : "Home"
        },
        "addressLine1" : {
          "$ref" : "#/definitions/addressLineType"
        },
        "addressLine2" : {
          "$ref" : "#/definitions/addressLineType"
        },
        "city" : {
          "description" : "Optional.",
          "type" : "string",
          "pattern" : "^[A-Za-z\\-\\'\\`\\&\\. ]{4,50}$"
        },
        "county" : {
          "description" : "Optional.",
          "type" : "string",
          "pattern" : "^[A-Za-z\\-\\'\\`\\&\\. ]{4,30}$"
        },
        "country" : {
          "description" : "Optional.",
          "type" : "string",
          "pattern" : "^[A-Za-z\\-\\'\\`\\&\\. ]{1,50}$"
        },
        "postcode" : {
          "description" : "Optional.",
          "type" : "string",
          "pattern" : "^[A-Z]{1,2}[0-9][0-9A-Z]?\\s?[0-9][A-Z]{2}$",
          "example" : "IP12 3AN"
        }
      }
    },
    "taxPayerType" : {
      "description" : "Mandatory. All the details of the tax payer.",
      "type" : "object",
      "additionalProperties" : false,
      "required" : [
        "taxPayerType",
        "referenceNumbers",
        "addresses"
      ],
      "properties" : {
        "taxPayerType" : {
          "description" : "Mandatory. A categorisation of the tax payer e.g. Individual, Partnership, Organisation",
          "type" : "string",
          "pattern" : "^[A-Za-z0-9\\/\\-\\. ]{1,40}$"
        },
        "segment" : {
          "description" : "Optional. The segment of the tax payer e.g. Micro A; needed\n    for an organistion type tax payer",
          "type" : "string",
          "pattern" : "^[A-Za-z0-9\\/\\- ]{1,60}$"
        },
        "nameDetails" : {
          "description" : "Optional. The name of the individual or organisation tax payer ",
          "oneOf" : [
            {
              "type" : "object",
              "additionalProperties" : false,
              "required" : [
                "firstName",
                "lastName"
              ],
              "properties" : {
                "title" : {
                  "description" : "Optional. The person's title.",
                  "type" : "string",
                  "enum" : [
                    "Unknown",
                    "Mr",
                    "Mrs",
                    "Miss",
                    "Ms",
                    "Dr",
                    "Sir",
                    "Rev",
                    "Professor",
                    "Lord"
                  ]
                },
                "firstName" : {
                  "$ref" : "#/definitions/nameType"
                },
                "lastName" : {
                  "$ref" : "#/definitions/nameType"
                }
              }
            },
            {
              "type" : "object",
              "additionalProperties" : false,
              "required" : [
                "organisationName"
              ],
              "properties" : {
                "organisationName" : {
                  "$ref" : "#/definitions/organisationNameType"
                }
              }
            }
          ]
        },
        "referenceNumbers" : {
          "description" : "Mandatory. An array of key/value pairs representing a reference for the customer.",
          "type" : "array",
          "minItems" : 1,
          "maxItems" : 50,
          "uniqueItems" : true,
          "items" : {
            "type" : "object",
            "additionalProperties" : false,
            "required" : [
              "referenceType",
              "referenceValue"
            ],
            "properties" : {
              "referenceType" : {
                "description" : "Mandatory. The type of the reference.",
                "type" : "string",
                "pattern" : "^[A-Za-z\\/\\-\\. ]{1,100}$"
              },
              "referenceValue" : {
                "description" : "Mandatory. The value of the reference.",
                "type" : "string",
                "pattern" : "^[A-Z0-9]{5,25}$"
              }
            }
          }
        },
        "addresses" : {
          "description" : "Mandatory. A list of addresses of the tax payer",
          "type" : "array",
          "minItems" : 1,
          "maxItems" : 50,
          "uniqueItems" : true,
          "items" : {
            "$ref" : "#/definitions/addressEntry"
          }
        }
      }
    }
  }
}
